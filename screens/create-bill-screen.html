<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create a Bill - BillFlow</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary-green: #0f172a;
        --secondary-green: #f0fdf8;
        --accent-green: #059669;
        --light-grey: #f8fafc;
        --medium-grey: #f1f5f9;
        --border-grey: #e2e8f0;
        --dark-border: #cbd5e1;
        --text-dark: #0f172a;
        --text-medium: #334155;
        --text-light: #64748b;
        --accent-blue: #3b82f6;
        --success-green: #10b981;
        --warning-orange: #f59e0b;
        --danger-red: #ef4444;
        --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        --shadow-floating: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        background: linear-gradient(135deg, var(--primary-green) 0%, #1e293b 100%);
        color: var(--text-dark);
        height: 100vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      header {
        height: 60px;
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding: 0 24px;
        display: grid;
        align-items: center;
        grid-template-columns: 1fr 2fr 1fr;
        grid-template-areas: "name center buttons";
      }

      .name-section {
        grid-area: name;
        display: flex;
        align-items: center;
        justify-content: flex-start;
      }

      .main-section {
        grid-area: center;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
      }

      .brand-name {
        font-size: 24px;
        font-weight: 700;
        color: white;
        margin-right: 8px;
      }

      .screen-name {
        font-size: 14px;
        font-weight: 400;
        color: rgba(255, 255, 255, 0.7);
      }

      .buttons-section {
        grid-area: buttons;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        gap: 12px;
      }

      .header-btn {
        padding: 8px 16px;
        background: rgba(255, 255, 255, 0.1);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        cursor: pointer;
        font-size: 13px;
        font-weight: 500;
        text-decoration: none;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .header-btn:hover {
        background: rgba(255, 255, 255, 0.15);
        border-color: rgba(255, 255, 255, 0.3);
      }

      .header-btn.primary {
        background: var(--accent-green);
        border-color: var(--accent-green);
      }

      main {
        flex: 1;
        display: flex;
        gap: 24px;
        padding: 24px;
        overflow: hidden;
      }

      /* Left Side - Bill Preview */
      .bill-preview-container {
        flex: 1.2;
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .bill-preview {
        background: linear-gradient(145deg, #ffffff 0%, #fafbfb 100%);
        border-radius: 20px;
        padding: 40px;
        box-shadow: var(--shadow-floating);
        position: relative;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.8);
        flex: 1;
        overflow-y: auto;
      }

      .bill-preview::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 6px;
        background: linear-gradient(90deg, var(--accent-green), var(--success-green), var(--accent-blue));
        border-radius: 20px 20px 0 0;
      }

      .bill-header {
        display: flex;
        justify-content: space-between;
        align-items: start;
        margin-bottom: 40px;
        padding-bottom: 24px;
        border-bottom: 2px solid var(--border-grey);
      }

      .company-info h3 {
        font-size: 28px;
        font-weight: 800;
        color: var(--primary-green);
        margin-bottom: 8px;
      }

      .company-info p {
        color: var(--text-light);
        font-size: 14px;
        line-height: 1.5;
      }

      .bill-meta {
        text-align: right;
      }

      .bill-number {
        font-size: 24px;
        font-weight: 700;
        color: var(--accent-green);
        margin-bottom: 6px;
      }

      .bill-date {
        color: var(--text-light);
        font-size: 14px;
        font-weight: 500;
      }

      .customer-section {
        margin-bottom: 32px;
        padding: 20px;
        background: var(--medium-grey);
        border-radius: 12px;
        border-left: 4px solid var(--accent-green);
      }

      .customer-section h4 {
        font-size: 16px;
        font-weight: 600;
        color: var(--text-dark);
        margin-bottom: 8px;
      }

      .customer-details p {
        color: var(--text-medium);
        font-size: 14px;
        margin-bottom: 4px;
      }

      .bill-items {
        margin-bottom: 32px;
      }

      .items-header {
        display: grid;
        grid-template-columns: 2.5fr 0.8fr 1.2fr 1fr 1fr;
        gap: 16px;
        padding: 16px 0;
        border-bottom: 2px solid var(--border-grey);
        font-weight: 700;
        color: var(--text-dark);
        font-size: 13px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .bill-item {
        display: grid;
        grid-template-columns: 2.5fr 0.8fr 1.2fr 1fr 1fr;
        gap: 16px;
        padding: 16px 0;
        border-bottom: 1px solid var(--border-grey);
        font-size: 14px;
        transition: all 0.2s ease;
      }

      .bill-item:hover {
        background: var(--secondary-green);
        margin: 0 -16px;
        padding: 16px;
        border-radius: 8px;
      }

      .item-name {
        font-weight: 600;
        color: var(--text-dark);
      }

      .item-batch {
        font-size: 12px;
        color: var(--text-light);
        background: var(--medium-grey);
        padding: 2px 8px;
        border-radius: 12px;
        display: inline-block;
        margin-top: 4px;
      }

      .item-detail {
        color: var(--text-medium);
        text-align: center;
        font-weight: 500;
      }

      .item-total {
        font-weight: 700;
        color: var(--accent-green);
        text-align: right;
      }

      .bill-calculations {
        margin-top: 32px;
        padding-top: 24px;
        border-top: 2px solid var(--border-grey);
      }

      .calculation-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
        font-size: 15px;
      }

      .calculation-row.subtotal {
        font-weight: 600;
        color: var(--text-dark);
      }

      .calculation-row.tax {
        color: var(--text-medium);
        padding-left: 16px;
        font-size: 14px;
      }

      .calculation-row.discount {
        color: var(--warning-orange);
        font-weight: 600;
      }

      .calculation-row.total {
        font-size: 20px;
        font-weight: 800;
        color: var(--primary-green);
        border-top: 2px solid var(--border-grey);
        padding-top: 16px;
        margin-top: 16px;
        background: var(--secondary-green);
        margin: 16px -20px 0 -20px;
        padding: 16px 20px;
        border-radius: 12px;
      }

      .bill-notes {
        margin-top: 24px;
        padding: 16px;
        background: var(--medium-grey);
        border-radius: 12px;
        border-left: 4px solid var(--accent-blue);
      }

      .bill-notes h5 {
        font-size: 14px;
        font-weight: 600;
        color: var(--text-dark);
        margin-bottom: 8px;
      }

      .bill-notes p {
        font-size: 13px;
        color: var(--text-medium);
        line-height: 1.4;
      }

      /* Floating Action Buttons */
      .floating-actions {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 12px;
      }

      .action-btn {
        padding: 14px 20px;
        border: none;
        border-radius: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        position: relative;
        overflow: hidden;
      }

      .action-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.5s;
      }

      .action-btn:hover::before {
        left: 100%;
      }

      .action-btn.primary {
        background: linear-gradient(135deg, var(--accent-green), var(--success-green));
        color: white;
        box-shadow: var(--shadow-md);
      }

      .action-btn.secondary {
        background: white;
        color: var(--text-dark);
        border: 1px solid var(--border-grey);
        box-shadow: var(--shadow-sm);
      }

      .action-btn.warning {
        background: linear-gradient(135deg, var(--warning-orange), #f97316);
        color: white;
        box-shadow: var(--shadow-md);
      }

      .action-btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
      }

      /* Right Side - Form */
      .bill-form {
        flex: 1;
        background: white;
        border-radius: 20px;
        padding: 32px;
        box-shadow: var(--shadow-xl);
        overflow-y: auto;
        border: 1px solid var(--border-grey);
      }

      .form-section {
        margin-bottom: 32px;
      }

      .section-title {
        font-size: 20px;
        font-weight: 700;
        color: var(--primary-green);
        margin-bottom: 20px;
        padding-bottom: 12px;
        border-bottom: 2px solid var(--border-grey);
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .section-icon {
        width: 24px;
        height: 24px;
        background: var(--accent-green);
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 12px;
      }

      .form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 16px;
      }

      .form-group {
        display: flex;
        flex-direction: column;
      }

      .form-group.full-width {
        grid-column: span 2;
      }

      .form-label {
        font-size: 14px;
        font-weight: 600;
        color: var(--text-dark);
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .required {
        color: var(--danger-red);
      }

      .form-input, .form-select {
        padding: 12px 16px;
        border: 2px solid var(--border-grey);
        border-radius: 10px;
        font-size: 14px;
        transition: all 0.3s ease;
        font-family: inherit;
      }

      .form-input:focus, .form-select:focus {
        outline: none;
        border-color: var(--accent-blue);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        transform: translateY(-1px);
      }

      .form-input::placeholder {
        color: var(--text-light);
      }

      /* Tax Section */
      .tax-section {
        background: var(--secondary-green);
        border-radius: 16px;
        padding: 24px;
        border: 2px solid rgba(5, 150, 105, 0.1);
      }

      .tax-item {
        display: grid;
        grid-template-columns: 2fr 1fr auto;
        gap: 12px;
        align-items: center;
        padding: 12px;
        background: white;
        border-radius: 10px;
        margin-bottom: 12px;
        box-shadow: var(--shadow-xs);
        border: 1px solid var(--border-grey);
      }

      .add-tax-btn {
        width: 100%;
        padding: 12px;
        border: 2px dashed var(--accent-green);
        background: transparent;
        color: var(--accent-green);
        border-radius: 10px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .add-tax-btn:hover {
        background: var(--accent-green);
        color: white;
      }

      /* Items Section */
      .items-section {
        background: var(--medium-grey);
        border-radius: 16px;
        padding: 24px;
        border: 2px solid var(--border-grey);
      }

      .items-list {
        margin-bottom: 16px;
      }

      .item-row {
        display: grid;
        grid-template-columns: 2fr 0.8fr 1.2fr 1fr 1fr auto;
        gap: 12px;
        align-items: center;
        padding: 16px;
        background: white;
        border-radius: 12px;
        margin-bottom: 12px;
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--border-grey);
        transition: all 0.3s ease;
      }

      .item-row:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      .item-input {
        padding: 10px 12px;
        border: 1px solid var(--border-grey);
        border-radius: 8px;
        font-size: 13px;
        transition: all 0.2s ease;
      }

      .item-input:focus {
        border-color: var(--accent-blue);
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
        outline: none;
      }

      .remove-btn {
        padding: 8px;
        border: none;
        background: var(--danger-red);
        color: white;
        border-radius: 8px;
        cursor: pointer;
        font-size: 12px;
        transition: all 0.3s ease;
      }

      .remove-btn:hover {
        background: #dc2626;
        transform: scale(1.05);
      }

      .add-item-btn {
        width: 100%;
        padding: 16px;
        border: 2px dashed var(--accent-green);
        background: transparent;
        color: var(--accent-green);
        border-radius: 12px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        font-size: 15px;
      }

      .add-item-btn:hover {
        background: var(--accent-green);
        color: white;
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      /* Modal Styles */
      .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(5px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .modal.active {
        opacity: 1;
        visibility: visible;
      }

      .modal-content {
        background: white;
        border-radius: 20px;
        padding: 32px;
        width: 90%;
        max-width: 600px;
        max-height: 80vh;
        overflow-y: auto;
        transform: scale(0.9) translateY(20px);
        transition: all 0.3s ease;
        box-shadow: var(--shadow-floating);
        border: 1px solid var(--border-grey);
      }

      .modal.active .modal-content {
        transform: scale(1) translateY(0);
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
        padding-bottom: 16px;
        border-bottom: 2px solid var(--border-grey);
      }

      .modal-title {
        font-size: 24px;
        font-weight: 700;
        color: var(--primary-green);
      }

      .close-modal {
        width: 36px;
        height: 36px;
        background: var(--medium-grey);
        border: none;
        border-radius: 50%;
        font-size: 18px;
        cursor: pointer;
        color: var(--text-light);
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .close-modal:hover {
        background: var(--danger-red);
        color: white;
      }

      .search-bar {
        width: 100%;
        padding: 16px 20px;
        border: 2px solid var(--border-grey);
        border-radius: 12px;
        font-size: 16px;
        margin-bottom: 20px;
        transition: all 0.3s ease;
      }

      .search-bar:focus {
        border-color: var(--accent-blue);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        outline: none;
      }

      .product-list {
        max-height: 400px;
        overflow-y: auto;
      }

      .product-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px;
        border: 1px solid var(--border-grey);
        border-radius: 12px;
        margin-bottom: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        background: white;
      }

      .product-item:hover {
        background: var(--secondary-green);
        border-color: var(--accent-green);
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      .product-info h4 {
        font-size: 16px;
        font-weight: 600;
        color: var(--text-dark);
        margin-bottom: 6px;
      }

      .product-info p {
        font-size: 13px;
        color: var(--text-light);
      }

      .product-price {
        font-size: 18px;
        font-weight: 700;
        color: var(--accent-green);
      }

      /* Empty state */
      .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: var(--text-light);
      }

      .empty-state .empty-icon {
        width: 64px;
        height: 64px;
        background: var(--medium-grey);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 16px;
        font-size: 24px;
      }

      .empty-state h3 {
        font-size: 18px;
        margin-bottom: 8px;
        color: var(--text-medium);
      }

      .empty-state p {
        font-size: 14px;
      }

      /* Scrollbar Styling */
      ::-webkit-scrollbar {
        width: 8px;
      }

      ::-webkit-scrollbar-track {
        background: var(--medium-grey);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb {
        background: var(--border-grey);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: var(--text-light);
      }
    </style>
</head>
<body>
  <header>
    <div class="name-section">
      <a class="header-btn" href="main-layout.html">
        ‚Üê Back to Dashboard
      </a>
    </div>
    <div class="main-section">
      <div class="brand-name">Create Invoice</div>
      <div class="screen-name">Professional Billing System</div>
    </div>
    <div class="buttons-section">
      <button class="header-btn">üíæ Auto Save: ON</button>
      <button class="header-btn primary">‚ö° Quick Actions</button>
    </div>
  </header>

  <main>
    <!-- Left Side - Bill Preview -->
    <div class="bill-preview-container">
      <div class="bill-preview">
        <div class="bill-header">
          <div class="company-info">
            <h3 id="preview-company">BillFlow Solutions</h3>
            <p id="preview-company-address">123 Business District, Tech Park<br>Mumbai, Maharashtra 400001<br>GST: 27ABCDE1234F1Z5</p>
          </div>
          <div class="bill-meta">
            <div class="bill-number" id="preview-bill-number">INV-001</div>
            <div class="bill-date" id="preview-date">March 15, 2024</div>
          </div>
        </div>

        <div class="customer-section" id="customer-preview" style="display: none;">
          <h4>Bill To:</h4>
          <div class="customer-details">
            <p id="preview-customer-name"></p>
            <p id="preview-customer-phone"></p>
            <p id="preview-customer-address"></p>
          </div>
        </div>

        <div class="bill-items">
          <div class="items-header">
            <div>Item Description</div>
            <div>Qty</div>
            <div>Batch/HSN</div>
            <div>Rate</div>
            <div>Amount</div>
          </div>
          <div id="preview-items">
            <div class="empty-state">
              <div class="empty-icon">üìã</div>
              <h3>No items added yet</h3>
              <p>Add items to your invoice to see them appear here</p>
            </div>
          </div>
        </div>

        <div class="bill-calculations">
          <div class="calculation-row subtotal">
            <span>Subtotal:</span>
            <span id="preview-subtotal">‚Çπ0.00</span>
          </div>
          <div id="preview-taxes">
            <!-- Tax items will be added here -->
          </div>
          <div class="calculation-row discount" id="preview-discount-row" style="display: none;">
            <span>Discount:</span>
            <span id="preview-discount">‚Çπ0.00</span>
          </div>
          <div class="calculation-row total">
            <span>Total Amount:</span>
            <span id="preview-total">‚Çπ0.00</span>
          </div>
        </div>

        <div class="bill-notes" id="preview-notes" style="display: none;">
          <h5>Notes:</h5>
          <p id="preview-notes-text"></p>
        </div>
      </div>

      <div class="floating-actions">
        <button class="action-btn secondary">
          üíæ Save Draft
        </button>
        <button class="action-btn warning">
          üìß Send Email
        </button>
        <button class="action-btn primary">
          üìÑ Generate PDF
        </button>
      </div>
    </div>

    <!-- Right Side - Form -->
    <div class="bill-form">
      <div class="form-section">
        <h3 class="section-title">
          <span class="section-icon">üìã</span>
          Invoice Details
        </h3>
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">Invoice Number <span class="required">*</span></label>
            <input type="text" class="form-input" id="bill-number" value="INV-001">
          </div>
          <div class="form-group">
            <label class="form-label">Date <span class="required">*</span></label>
            <input type="date" class="form-input" id="bill-date">
          </div>
          <div class="form-group">
            <label class="form-label">Due Date</label>
            <input type="date" class="form-input" id="due-date">
          </div>
          <div class="form-group">
            <label class="form-label">Payment Terms</label>
            <select class="form-select" id="payment-terms">
              <option value="net-30">Net 30 Days</option>
              <option value="net-15">Net 15 Days</option>
              <option value="due-on-receipt">Due on Receipt</option>
              <option value="custom">Custom Terms</option>
            </select>
          </div>
        </div>
      </div>

      <div class="form-section">
        <h3 class="section-title">
          <span class="section-icon">üë§</span>
          Customer Information
        </h3>
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">Customer Name <span class="required">*</span></label>
            <input type="text" class="form-input" id="customer-name" placeholder="Enter customer name">
          </div>
          <div class="form-group">
            <label class="form-label">Phone Number</label>
            <input type="tel" class="form-input" id="customer-phone" placeholder="+91 98765 43210">
          </div>
          <div class="form-group">
            <label class="form-label">Email Address</label>
            <input type="email" class="form-input" id="customer-email" placeholder="customer@example.com">
          </div>
          <div class="form-group">
            <label class="form-label">GST Number</label>
            <input type="text" class="form-input" id="customer-gst" placeholder="27ABCDE1234F1Z5">
          </div>
          <div class="form-group full-width">
            <label class="form-label">Billing Address</label>
            <textarea class="form-input" id="customer-address" rows="3" placeholder="Enter complete billing address"></textarea>
          </div>
        </div>
      </div>

      <div class="form-section">
        <h3 class="section-title">
          <span class="section-icon">üì¶</span>
          Items & Services
        </h3>
        <div class="items-section">
          <div class="items-list" id="form-items">
            <!-- Items will be added here -->
          </div>
          <button class="add-item-btn" onclick="openProductModal()">
            ‚ûï Add New Item
          </button>
        </div>
      </div>

      <div class="form-section">
        <h3 class="section-title">
          <span class="section-icon">üßæ</span>
          Taxes & Charges
        </h3>
        <div class="tax-section">
          <div class="tax-list" id="tax-items">
            <div class="tax-item">
              <input type="text" class="form-input" placeholder="Tax Name (e.g., CGST)" value="CGST" onchange="updateTaxes()">
              <input type="number" class="form-input" placeholder="%" value="9" step="0.01" onchange="updateTaxes()">
              <button class="remove-btn" onclick="removeTaxItem(this)">√ó</button>
            </div>
            <div class="tax-item">
              <input type="text" class="form-input" placeholder="Tax Name (e.g., SGST)" value="SGST" onchange="updateTaxes()">
              <input type="number" class="form-input" placeholder="%" value="9" step="0.01" onchange="updateTaxes()">
              <button class="remove-btn" onclick="removeTaxItem(this)">√ó</button>
            </div>
          </div>
          <button class="add-tax-btn" onclick="addTaxItem()">
            ‚ûï Add Tax/Charge
          </button>
        </div>
      </div>

      <div class="form-section">
        <h3 class="section-title">
          <span class="section-icon">üí≥</span>
          Payment & Additional Details
        </h3>
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">Payment Status</label>
            <select class="form-select" id="payment-status">
              <option value="unpaid">Unpaid</option>
              <option value="partial">Partially Paid</option>
              <option value="paid">Paid in Full</option>
              <option value="overdue">Overdue</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Payment Method</label>
            <select class="form-select" id="payment-method">
              <option value="">Select Method</option>
              <option value="cash">Cash</option>
              <option value="card">Credit/Debit Card</option>
              <option value="upi">UPI Payment</option>
              <option value="bank">Bank Transfer</option>
              <option value="cheque">Cheque</option>
              <option value="online">Online Payment</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Discount Amount</label>
            <input type="number" class="form-input" id="discount-amount" placeholder="0.00" step="0.01" onchange="updatePreview()">
          </div>
          <div class="form-group">
            <label class="form-label">Discount Type</label>
            <select class="form-select" id="discount-type" onchange="updatePreview()">
              <option value="amount">Fixed Amount</option>
              <option value="percentage">Percentage</option>
            </select>
          </div>
          <div class="form-group full-width">
            <label class="form-label">Notes & Terms</label>
            <textarea class="form-input" id="notes" rows="4" placeholder="Add payment terms, delivery instructions, or other important notes..." onchange="updatePreview()"></textarea>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Product Selection Modal -->
  <div class="modal" id="productModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Select Products & Services</h3>
        <button class="close-modal" onclick="closeProductModal()">√ó</button>
      </div>
      
      <input type="text" class="search-bar" id="productSearch" placeholder="üîç Search products, services, or HSN codes..." oninput="filterProducts()">
      
      <div class="product-list" id="productList">
        <!-- Sample products will be loaded here -->
      </div>
    </div>
  </div>

  <script>
    let billItems = [];
    let itemCounter = 0;

    // Enhanced products database
    const products = [
      { id: 1, name: 'Premium Tea Leaves', batch: 'TEA001', hsn: '0902', price: 450.00, category: 'Beverages', description: 'Organic Darjeeling Tea' },
      { id: 2, name: 'Organic Coffee Beans', batch: 'COF001', hsn: '0901', price: 680.00, category: 'Beverages', description: 'Arabica Coffee Beans' },
      { id: 3, name: 'Assorted Cookies', batch: 'COK001', hsn: '1905', price: 280.00, category: 'Bakery', description: 'Chocolate Chip Cookies' },
      { id: 4, name: 'Premium Honey', batch: 'HON001', hsn: '0409', price: 520.00, category: 'Natural Products', description: 'Raw Organic Honey' },
      { id: 5, name: 'Green Tea Bags', batch: 'TEA002', hsn: '0902', price: 250.00, category: 'Beverages', description: 'Jasmine Green Tea' },
      { id: 6, name: 'Dark Chocolate', batch: 'CHO001', hsn: '1806', price: 380.00, category: 'Confectionery', description: '70% Cocoa Dark Chocolate' },
      { id: 7, name: 'Herbal Tea Mix', batch: 'TEA003', hsn: '0902', price: 320.00, category: 'Beverages', description: 'Ayurvedic Herbal Blend' },
      { id: 8, name: 'Roasted Almonds', batch: 'NUT001', hsn: '0802', price: 750.00, category: 'Dry Fruits', description: 'Premium California Almonds' },
      { id: 9, name: 'Consulting Services', batch: 'SRV001', hsn: '9983', price: 2500.00, category: 'Services', description: 'Business Consultation' },
      { id: 10, name: 'Website Development', batch: 'SRV002', hsn: '9983', price: 15000.00, category: 'Services', description: 'Custom Website Development' }
    ];

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      const today = new Date();
      const dueDate = new Date(today.getTime() + (30 * 24 * 60 * 60 * 1000)); // 30 days from today
      
      document.getElementById('bill-date').value = today.toISOString().split('T')[0];
      document.getElementById('due-date').value = dueDate.toISOString().split('T')[0];
      
      renderProducts();
      updatePreview();
      
      // Add event listeners
      addFormEventListeners();
    });

    function addFormEventListeners() {
      const inputs = ['bill-number', 'customer-name', 'customer-phone', 'customer-email', 'customer-address', 'notes'];
      inputs.forEach(id => {
        document.getElementById(id).addEventListener('input', updatePreview);
      });
      
      document.getElementById('bill-date').addEventListener('change', updatePreview);
    }

    function openProductModal() {
      document.getElementById('productModal').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeProductModal() {
      document.getElementById('productModal').classList.remove('active');
      document.body.style.overflow = '';
    }

    function renderProducts() {
      const productList = document.getElementById('productList');
      productList.innerHTML = products.map(product => `
        <div class="product-item" onclick="selectProduct(${product.id})">
          <div class="product-info">
            <h4>${product.name}</h4>
            <p>${product.description} | HSN: ${product.hsn} | Batch: ${product.batch}</p>
          </div>
          <div class="product-price">‚Çπ${product.price.toFixed(2)}</div>
        </div>
      `).join('');
    }

    function filterProducts() {
      const search = document.getElementById('productSearch').value.toLowerCase();
      const filtered = products.filter(product => 
        product.name.toLowerCase().includes(search) ||
        product.batch.toLowerCase().includes(search) ||
        product.hsn.toLowerCase().includes(search) ||
        product.category.toLowerCase().includes(search) ||
        product.description.toLowerCase().includes(search)
      );
      
      const productList = document.getElementById('productList');
      productList.innerHTML = filtered.map(product => `
        <div class="product-item" onclick="selectProduct(${product.id})">
          <div class="product-info">
            <h4>${product.name}</h4>
            <p>${product.description} | HSN: ${product.hsn} | Batch: ${product.batch}</p>
          </div>
          <div class="product-price">‚Çπ${product.price.toFixed(2)}</div>
        </div>
      `).join('');
    }

    function selectProduct(productId) {
      const product = products.find(p => p.id === productId);
      if (product) {
        addItemToList(product);
        closeProductModal();
        document.getElementById('productSearch').value = '';
        renderProducts();
      }
    }

    function addItemToList(product) {
      const item = {
        id: ++itemCounter,
        name: product.name,
        quantity: 1,
        batch: product.batch,
        hsn: product.hsn,
        price: product.price,
        total: product.price
      };
      
      billItems.push(item);
      renderFormItems();
      updatePreview();
    }

    function renderFormItems() {
      const formItems = document.getElementById('form-items');
      formItems.innerHTML = billItems.map(item => `
        <div class="item-row">
          <input type="text" class="item-input" value="${item.name}" onchange="updateItem(${item.id}, 'name', this.value)">
          <input type="number" class="item-input" value="${item.quantity}" min="1" onchange="updateItem(${item.id}, 'quantity', this.value)">
          <input type="text" class="item-input" value="${item.batch}" onchange="updateItem(${item.id}, 'batch', this.value)">
          <input type="number" class="item-input" value="${item.price}" step="0.01" onchange="updateItem(${item.id}, 'price', this.value)">
          <input type="number" class="item-input" value="${item.total.toFixed(2)}" readonly>
          <button class="remove-btn" onclick="removeItem(${item.id})" title="Remove Item">√ó</button>
        </div>
      `).join('');
    }

    function updateItem(id, field, value) {
      const item = billItems.find(item => item.id === id);
      if (item) {
        item[field] = field === 'name' || field === 'batch' ? value : parseFloat(value) || 0;
        if (field === 'quantity' || field === 'price') {
          item.total = item.quantity * item.price;
        }
        renderFormItems();
        updatePreview();
      }
    }

    function removeItem(id) {
      billItems = billItems.filter(item => item.id !== id);
      renderFormItems();
      updatePreview();
    }

    function addTaxItem() {
      const taxList = document.getElementById('tax-items');
      const newTaxItem = document.createElement('div');
      newTaxItem.className = 'tax-item';
      newTaxItem.innerHTML = `
        <input type="text" class="form-input" placeholder="Tax Name (e.g., IGST)" onchange="updateTaxes()">
        <input type="number" class="form-input" placeholder="%" step="0.01" onchange="updateTaxes()">
        <button class="remove-btn" onclick="removeTaxItem(this)">√ó</button>
      `;
      taxList.appendChild(newTaxItem);
    }

    function removeTaxItem(button) {
      button.parentElement.remove();
      updateTaxes();
    }

    function updateTaxes() {
      updatePreview();
    }

    function getTaxItems() {
      const taxItems = document.querySelectorAll('#tax-items .tax-item');
      const taxes = [];
      
      taxItems.forEach(item => {
        const nameInput = item.querySelector('input[type="text"]');
        const percentInput = item.querySelector('input[type="number"]');
        
        if (nameInput.value && percentInput.value) {
          taxes.push({
            name: nameInput.value,
            percent: parseFloat(percentInput.value) || 0
          });
        }
      });
      
      return taxes;
    }

    function updatePreview() {
      const previewItems = document.getElementById('preview-items');
      
      // Update customer info
      const customerName = document.getElementById('customer-name').value;
      const customerPhone = document.getElementById('customer-phone').value;
      const customerAddress = document.getElementById('customer-address').value;
      
      const customerPreview = document.getElementById('customer-preview');
      if (customerName || customerPhone || customerAddress) {
        customerPreview.style.display = 'block';
        document.getElementById('preview-customer-name').textContent = customerName || 'Customer Name';
        document.getElementById('preview-customer-phone').textContent = customerPhone ? `Phone: ${customerPhone}` : '';
        document.getElementById('preview-customer-address').textContent = customerAddress || '';
      } else {
        customerPreview.style.display = 'none';
      }
      
      // Update items
      if (billItems.length === 0) {
        previewItems.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">üìã</div>
            <h3>No items added yet</h3>
            <p>Add items to your invoice to see them appear here</p>
          </div>
        `;
      } else {
        previewItems.innerHTML = billItems.map(item => `
          <div class="bill-item">
            <div class="item-name">
              ${item.name}
              <div class="item-batch">HSN: ${item.hsn || item.batch}</div>
            </div>
            <div class="item-detail">${item.quantity}</div>
            <div class="item-detail">${item.batch}</div>
            <div class="item-detail">‚Çπ${item.price.toFixed(2)}</div>
            <div class="item-total">‚Çπ${item.total.toFixed(2)}</div>
          </div>
        `).join('');
      }

      // Calculate totals
      const subtotal = billItems.reduce((sum, item) => sum + item.total, 0);
      
      // Get taxes
      const taxes = getTaxItems();
      let totalTaxAmount = 0;
      
      // Update tax display
      const previewTaxes = document.getElementById('preview-taxes');
      previewTaxes.innerHTML = taxes.map(tax => {
        const taxAmount = (subtotal * tax.percent) / 100;
        totalTaxAmount += taxAmount;
        return `
          <div class="calculation-row tax">
            <span>${tax.name} (${tax.percent}%):</span>
            <span>‚Çπ${taxAmount.toFixed(2)}</span>
          </div>
        `;
      }).join('');
      
      // Calculate discount
      const discountAmount = parseFloat(document.getElementById('discount-amount').value) || 0;
      const discountType = document.getElementById('discount-type').value;
      let finalDiscount = 0;
      
      if (discountAmount > 0) {
        finalDiscount = discountType === 'percentage' 
          ? (subtotal * discountAmount) / 100 
          : discountAmount;
          
        document.getElementById('preview-discount-row').style.display = 'flex';
        document.getElementById('preview-discount').textContent = `-‚Çπ${finalDiscount.toFixed(2)}`;
      } else {
        document.getElementById('preview-discount-row').style.display = 'none';
      }
      
      const total = subtotal + totalTaxAmount - finalDiscount;

      document.getElementById('preview-subtotal').textContent = `‚Çπ${subtotal.toFixed(2)}`;
      document.getElementById('preview-total').textContent = `‚Çπ${total.toFixed(2)}`;

      // Update bill info
      document.getElementById('preview-bill-number').textContent = document.getElementById('bill-number').value || 'INV-001';
      document.getElementById('preview-date').textContent = formatDate(document.getElementById('bill-date').value);
      
      // Update notes
      const notes = document.getElementById('notes').value;
      const notesPreview = document.getElementById('preview-notes');
      if (notes) {
        notesPreview.style.display = 'block';
        document.getElementById('preview-notes-text').textContent = notes;
      } else {
        notesPreview.style.display = 'none';
      }
    }

    function formatDate(dateStr) {
      if (!dateStr) return new Date().toLocaleDateString();
      return new Date(dateStr).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });
    }

    // Close modal on outside click
    document.getElementById('productModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeProductModal();
      }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeProductModal();
      }
      
      if (e.ctrlKey && e.key === 'Enter') {
        // Quick save functionality
        console.log('Quick save triggered');
      }
    });
  </script>
</body>
</html>